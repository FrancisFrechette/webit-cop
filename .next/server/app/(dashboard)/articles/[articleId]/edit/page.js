(()=>{var e={};e.id=2229,e.ids=[2229],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},74026:e=>{"use strict";e.exports=require("string_decoder")},98061:e=>{"use strict";e.exports=require("node:assert")},92761:e=>{"use strict";e.exports=require("node:async_hooks")},72254:e=>{"use strict";e.exports=require("node:buffer")},40027:e=>{"use strict";e.exports=require("node:console")},6005:e=>{"use strict";e.exports=require("node:crypto")},65714:e=>{"use strict";e.exports=require("node:diagnostics_channel")},15673:e=>{"use strict";e.exports=require("node:events")},88849:e=>{"use strict";e.exports=require("node:http")},42725:e=>{"use strict";e.exports=require("node:http2")},87503:e=>{"use strict";e.exports=require("node:net")},38846:e=>{"use strict";e.exports=require("node:perf_hooks")},39630:e=>{"use strict";e.exports=require("node:querystring")},84492:e=>{"use strict";e.exports=require("node:stream")},31764:e=>{"use strict";e.exports=require("node:tls")},41041:e=>{"use strict";e.exports=require("node:url")},47261:e=>{"use strict";e.exports=require("node:util")},93746:e=>{"use strict";e.exports=require("node:util/types")},24086:e=>{"use strict";e.exports=require("node:worker_threads")},65628:e=>{"use strict";e.exports=require("node:zlib")},49599:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>o,routeModule:()=>m,tree:()=>c}),s(39997),s(64095),s(35866),s(11506);var r=s(23191),a=s(88716),i=s(37922),l=s.n(i),n=s(95231),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);s.d(t,d);let c=["",{children:["(dashboard)",{children:["articles",{children:["[articleId]",{children:["edit",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,39997)),"C:\\Projets - Developpement\\cursor-webit-cop\\app\\(dashboard)\\articles\\[articleId]\\edit\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,64095)),"C:\\Projets - Developpement\\cursor-webit-cop\\app\\(dashboard)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,11506)),"C:\\Projets - Developpement\\cursor-webit-cop\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],o=["C:\\Projets - Developpement\\cursor-webit-cop\\app\\(dashboard)\\articles\\[articleId]\\edit\\page.tsx"],u="/(dashboard)/articles/[articleId]/edit/page",x={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(dashboard)/articles/[articleId]/edit/page",pathname:"/articles/[articleId]/edit",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},90783:(e,t,s)=>{Promise.resolve().then(s.bind(s,46952))},13215:(e,t,s)=>{Promise.resolve().then(s.bind(s,64101))},26444:()=>{},93710:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,12994,23)),Promise.resolve().then(s.t.bind(s,96114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,79671,23)),Promise.resolve().then(s.t.bind(s,41868,23)),Promise.resolve().then(s.t.bind(s,84759,23))},46952:(e,t,s)=>{"use strict";s.d(t,{default:()=>o});var r=s(10326),a=s(31591),i=s(24988),l=s(89660),n=s(17577),d=s(90434),c=s(35047);function o({children:e}){let{user:t,loading:s}=(0,a.z)(),{org:o,loading:u}=(0,i.X)(),{me:x}=function(){let[e,t]=(0,n.useState)(null),[s,r]=(0,n.useState)(!0),[a,i]=(0,n.useState)(null);return{me:e,loading:s,error:a,refetch:(0,n.useCallback)(async()=>{i(null),r(!0);try{let e=await (0,l.g)(),s=await fetch("/api/orgs/current/me",{headers:{...e},credentials:"include"});if(401===s.status||403===s.status){t(null),i("Non autoris\xe9");return}if(!s.ok){t(null),i("Erreur au chargement");return}let r=await s.json();t(r)}catch{t(null),i("Erreur au chargement")}finally{r(!1)}},[])}}();return((0,c.useRouter)(),(0,c.usePathname)(),s)?r.jsx("div",{className:"flex min-h-screen items-center justify-center bg-[#050816]",children:r.jsx("p",{className:"text-webit-fg-muted",children:"Chargement…"})}):t?(0,r.jsxs)("div",{className:"min-h-screen bg-[#050816] text-webit-fg",children:[r.jsx("header",{className:"border-b border-webit-panel-border",children:(0,r.jsxs)("div",{className:"layout-container flex h-14 items-center justify-between gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-6",children:[r.jsx(d.default,{href:"/pages",className:"text-sm font-semibold text-white hover:text-webit-accent",children:"Webit COP"}),(0,r.jsxs)("nav",{className:"flex gap-4",children:[r.jsx(d.default,{href:"/pages",className:"text-sm text-webit-fg-muted hover:text-webit-accent",children:"Pages"}),r.jsx(d.default,{href:"/articles",className:"text-sm text-webit-fg-muted hover:text-webit-accent",children:"Articles"}),r.jsx(d.default,{href:"/calendar",className:"text-sm text-webit-fg-muted hover:text-webit-accent",children:"Calendrier"}),x?.canManageMembers&&r.jsx(d.default,{href:"/org/members",className:"text-sm text-webit-fg-muted hover:text-webit-accent",children:"Membres & r\xf4les"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[t&&!u&&(0,r.jsxs)("span",{className:"text-webit-fg-muted",children:["Organisation : ",o?.name??"Organisation inconnue"]}),x&&(0,r.jsxs)("span",{className:"text-webit-fg-muted",title:"R\xf4le dans cette organisation",children:["Vous : ",x.orgRole]}),r.jsx("span",{className:"text-webit-fg-muted",children:t.displayName||t.email||t.uid}),r.jsx(d.default,{href:"/logout",className:"text-webit-fg-muted hover:text-webit-accent-rose",children:"D\xe9connexion"})]})]})}),e]}):null}},64101:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var r=s(10326),a=s(89660),i=s(47999),l=s(35047),n=s(17577),d=s(31591),c=s(24988);function o(e){try{return new Date(e).toLocaleDateString("fr-FR",{day:"2-digit",month:"long",year:"numeric"})}catch{return e}}let u={draft:"bg-slate-600/80 text-slate-200",preview:"bg-amber-600/80 text-white",published:"bg-emerald-600/80 text-white",archived:"bg-slate-700/80 text-slate-400"},x={draft:"Brouillon",preview:"Preview interne",published:"Publi\xe9",archived:"Archiv\xe9"};function m({params:e}){let t=(0,l.useRouter)(),[s,m]=(0,n.useState)(null),[p,h]=(0,n.useState)([]),[b,g]=(0,n.useState)([]),[f,j]=(0,n.useState)(null),[w,y]=(0,n.useState)([]),[N,v]=(0,n.useState)(!0),[S,C]=(0,n.useState)(!1),[P,k]=(0,n.useState)(!1),[_,E]=(0,n.useState)([]),[A,I]=(0,n.useState)(null),[q,T]=(0,n.useState)([]),[R,D]=(0,n.useState)(!1),[O,B]=(0,n.useState)(null),[F,U]=(0,n.useState)(null),[$,L]=(0,n.useState)(null),[M,J]=(0,n.useState)(!1),[X,G]=(0,n.useState)(null),[z,V]=(0,n.useState)(null),[H,K]=(0,n.useState)(!1),[W,Z]=(0,n.useState)([]),[Y,Q]=(0,n.useState)(""),[ee,et]=(0,n.useState)(!1),[es,er]=(0,n.useState)(null),{org:ea}=(0,c.X)(),{user:ei}=(0,d.z)(),el=S||P||M,en="new"===e.articleId;(0,n.useRef)(s).current=s,(0,n.useRef)({metaCategoryId:f,metaTagIds:w}).current={metaCategoryId:f,metaTagIds:w};let ed=(0,n.useCallback)(async e=>{if(s?.orgId&&s?.id&&("published"!==s.status||"draft"!==e&&"archived"!==e||window.confirm("archived"===e?"Archiver cet article ? Il ne sera plus visible sur le blog.":"Repasser en brouillon ? L’article ne sera plus visible sur le blog."))){I(null),C(!0);try{let t=await (0,a.g)(),r=await fetch(`/api/orgs/current/articles/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json",...t},credentials:"include",body:JSON.stringify({payload:s.current,status:e,categoryId:f,tagIds:w,publishAt:X??void 0,unpublishAt:z??void 0})});if(!r.ok){let e=await r.json().catch(()=>({}));I({type:"error",text:e.error??"Erreur"});return}let i=await r.json();m(i),G(i.publishAt??null),V(i.unpublishAt??null),I({type:"success",text:"Statut mis \xe0 jour."});let l=await fetch(`/api/orgs/current/articles/${s.id}/status-changes`,{headers:{...await (0,a.g)()},credentials:"include"});l.ok&&E(await l.json())}catch{I({type:"error",text:"Erreur r\xe9seau."})}finally{C(!1)}}},[s,f,w,X,z]),ec=(0,n.useCallback)(async e=>{if(s?.id&&window.confirm("Vous allez restaurer une ancienne version. Cette op\xe9ration cr\xe9era une nouvelle version et \xe9crasera les modifications non sauvegard\xe9es. Continuer ?")){I(null),U(e);try{let t=await (0,a.g)(),r=await fetch(`/api/orgs/current/articles/${s.id}/versions/rollback`,{method:"POST",headers:{"Content-Type":"application/json",...t},credentials:"include",body:JSON.stringify({versionNumber:e})});if(!r.ok){let e=await r.json().catch(()=>({}));I({type:"error",text:e.error??"Erreur lors de la restauration."});return}let i=await r.json();m(i),j(i.categoryId??null),y(i.tagIds??[]),B(null),I({type:"success",text:"Version restaur\xe9e."});let l=await fetch(`/api/orgs/current/articles/${s.id}/versions`,{headers:{...await (0,a.g)()},credentials:"include"});l.ok&&T(await l.json())}catch{I({type:"error",text:"Erreur r\xe9seau."})}finally{U(null)}}},[s]),eo=(0,n.useCallback)(async()=>{if(s?.id){I(null),k(!0);try{let e=await (0,a.g)(),t=await fetch(`/api/orgs/current/articles/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json",...e},credentials:"include",body:JSON.stringify({payload:s.current,status:s.status,categoryId:f,tagIds:w,publishAt:X??void 0,unpublishAt:z??void 0})});if(!t.ok){let e=await t.json().catch(()=>({}));I({type:"error",text:e.error??"Erreur"});return}let r=await t.json();m(r),G(r.publishAt??null),V(r.unpublishAt??null),I({type:"success",text:"M\xe9tadonn\xe9es enregistr\xe9es."})}catch{I({type:"error",text:"Erreur r\xe9seau."})}finally{k(!1)}}},[s,f,w,X,z]),eu=(0,n.useCallback)(async e=>{if(s?.id){et(!0),I(null);try{let t=await (0,a.g)(),r=await fetch(`/api/orgs/current/articles/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json",...t},credentials:"include",body:JSON.stringify({payload:s.current,status:s.status,categoryId:f,tagIds:w,publishAt:X??void 0,unpublishAt:z??void 0,editorialStatus:void 0!==e.editorialStatus?e.editorialStatus:s.editorialStatus,assignment:void 0!==e.assignment?e.assignment:s.assignment})});if(!r.ok){let e=await r.json().catch(()=>({}));I({type:"error",text:e.error??"Erreur"});return}let i=await r.json();m(i),I({type:"success",text:"Mis \xe0 jour."})}catch{I({type:"error",text:"Erreur r\xe9seau."})}finally{et(!1)}}},[s,f,w,X,z]);if(en)return null;if(N)return r.jsx("div",{className:"layout-container py-12",children:r.jsx("p",{className:"text-webit-fg-muted",children:"Chargement…"})});if(!s)return(0,r.jsxs)("div",{className:"layout-container py-8",children:[r.jsx("p",{className:"text-webit-fg-muted",children:"Article introuvable."}),r.jsx("button",{type:"button",className:"btn-secondary mt-4",onClick:()=>t.push("/articles"),children:"Retour aux articles"})]});let ex=s.status;return(0,r.jsxs)("div",{className:"layout-container py-8",children:[(0,r.jsxs)("div",{className:"mb-6 flex flex-wrap items-center justify-between gap-2",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("h1",{className:"text-3xl font-semibold text-white",children:"\xc9diter l’article"}),s.editorialStatus&&r.jsx("span",{className:`inline-flex rounded-full px-2.5 py-0.5 text-xs font-medium ${(0,i.Zj)(s.editorialStatus)}`,children:(0,i.gC)(s.editorialStatus)})]}),r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>t.push("/articles"),children:"Retour aux articles"})]}),A&&r.jsx("p",{className:"error"===A.type?"mb-4 text-webit-accent-rose":"mb-4 text-emerald-400",children:A.text}),$&&(0,r.jsxs)("p",{className:"mb-4 text-xs text-webit-fg-muted",children:["Brouillon enregistr\xe9 automatiquement \xe0 ",$,"."]}),(0,r.jsxs)("div",{className:"panel max-w-xl space-y-4",children:[r.jsx("p",{className:"text-webit-fg-muted",children:"\xc9diteur complet \xe0 venir (blocs, SEO, etc.). En attendant, vous pouvez g\xe9rer le statut de publication ci-dessous."}),(0,r.jsxs)("div",{className:"rounded-lg border border-webit-panel-border bg-slate-900/40 p-4",children:[r.jsx("p",{className:"mb-2 text-sm font-medium text-white",children:"Langue & traductions"}),(0,r.jsxs)("p",{className:"mb-2 text-xs text-webit-fg-muted",children:["Locale : ",r.jsx("span",{className:"font-mono text-white",children:s.locale??"fr-CA"})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"mb-1 text-xs text-webit-fg-muted",children:"Traductions li\xe9es"}),r.jsx("ul",{className:"mb-2 space-y-1 text-sm",children:0===(s.translations??[]).length?r.jsx("li",{className:"text-webit-fg-muted",children:"Aucune autre locale"}):(s.translations??[]).map(e=>(0,r.jsxs)("li",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-mono text-white",children:e.locale}),r.jsx("a",{href:`/articles/${e.id}/edit`,className:"text-webit-accent hover:underline",children:"Ouvrir"})]},e.id))}),ea?.supportedLocales&&ea.supportedLocales.length>1&&(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,r.jsxs)("select",{id:"new-translation-locale-article",className:"rounded border border-webit-panel-border bg-slate-900 px-2 py-1 text-sm text-white",defaultValue:"",children:[r.jsx("option",{value:"",children:"Choisir une locale"}),ea.supportedLocales.filter(e=>e!==s.locale&&!(s.translations??[]).some(t=>t.locale===e)).map(e=>r.jsx("option",{value:e,children:e},e))]}),r.jsx("button",{type:"button",className:"btn-secondary text-sm",disabled:H,onClick:async()=>{let e=document.getElementById("new-translation-locale-article"),t=e?.value?.trim();if(t){K(!0);try{let e=await (0,a.g)(),r=await fetch(`/api/orgs/current/articles/${s.id}/translations`,{method:"POST",headers:{"Content-Type":"application/json",...e},credentials:"include",body:JSON.stringify({targetLocale:t})});if(!r.ok){let e=await r.json().catch(()=>({}));I({type:"error",text:e.error??"Erreur \xe0 la cr\xe9ation de la traduction."});return}let{article:i}=await r.json();m(e=>e?{...e,translations:[...e.translations??[],{id:i.id,locale:t}]}:e),I({type:"success",text:"Traduction cr\xe9\xe9e."}),window.location.href=`/articles/${i.id}/edit`}catch{I({type:"error",text:"Erreur r\xe9seau."})}finally{K(!1)}}},children:H?"Cr\xe9ation…":"Cr\xe9er une traduction"})]})]})]}),(0,r.jsxs)("div",{className:"rounded-lg border border-webit-panel-border bg-slate-900/40 p-4",children:[r.jsx("p",{className:"mb-3 text-sm font-medium text-white",children:"Collaboration"}),(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("p",{className:"mb-1 text-xs text-webit-fg-muted",children:"Assign\xe9 \xe0"}),r.jsx("p",{className:"text-sm text-white",children:s.assignment?.assigneeUserName??"Personne"}),(0,r.jsxs)("div",{className:"mt-2 flex gap-2",children:[r.jsx("button",{type:"button",className:"btn-secondary text-sm",disabled:ee||!ei,onClick:()=>eu({assignment:{assigneeUserId:ei?.uid??null,assigneeUserName:ei?.displayName??ei?.email??null}}),children:"M'assigner"}),r.jsx("button",{type:"button",className:"btn-secondary text-sm",disabled:ee,onClick:()=>eu({assignment:null}),children:"Retirer l'assignation"})]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{className:"mb-1 block text-xs text-webit-fg-muted",children:"Statut de revue \xe9ditoriale"}),r.jsx("select",{className:"w-full rounded border border-webit-panel-border bg-slate-900 px-2 py-1.5 text-sm text-white",value:s.editorialStatus??"not_needed",onChange:e=>eu({editorialStatus:e.target.value||"not_needed"}),disabled:ee,children:Object.keys(i.wR).map(e=>r.jsx("option",{value:e,children:i.wR[e]},e))})]}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"mb-2 text-xs text-webit-fg-muted",children:"Commentaires"}),r.jsx("ul",{className:"mb-3 space-y-2",children:W.map(e=>(0,r.jsxs)("li",{className:`rounded border border-webit-panel-border/60 bg-slate-800/40 px-3 py-2 text-sm ${e.resolved?"opacity-75":""}`,children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-1",children:[r.jsx("span",{className:"font-medium text-white",children:e.authorUserName??"Anonyme"}),(0,r.jsxs)("span",{className:"text-xs text-webit-fg-muted",children:[new Date(e.createdAt).toLocaleString("fr-FR"),e.resolved&&r.jsx("span",{className:"ml-2 rounded bg-emerald-600/80 px-1.5 py-0.5 text-white",children:"R\xe9solu"})]})]}),r.jsx("p",{className:"mt-1 text-webit-fg-muted",children:e.body}),!e.resolved&&r.jsx("button",{type:"button",className:"mt-2 text-xs text-webit-accent hover:underline disabled:opacity-50",disabled:null!==es,onClick:async()=>{er(e.id);try{let t=await (0,a.g)();if((await fetch(`/api/orgs/current/articles/${s.id}/comments/${e.id}`,{method:"PATCH",headers:{"Content-Type":"application/json",...t},credentials:"include",body:JSON.stringify({resolved:!0})})).ok){let e=await fetch(`/api/orgs/current/articles/${s.id}/comments`,{headers:{...await (0,a.g)()},credentials:"include"}).then(e=>e.json());Z(e)}}finally{er(null)}},children:es===e.id?"…":"Marquer comme r\xe9solu"})]},e.id))}),(0,r.jsxs)("div",{children:[r.jsx("textarea",{className:"mb-2 w-full rounded border border-webit-panel-border bg-slate-900 px-2 py-1.5 text-sm text-white",rows:2,placeholder:"Ajouter un commentaire…",value:Y,onChange:e=>Q(e.target.value)}),r.jsx("button",{type:"button",className:"btn-secondary text-sm",disabled:!Y.trim(),onClick:async()=>{let e=Y.trim();if(!e)return;let t=await (0,a.g)(),r=await fetch(`/api/orgs/current/articles/${s.id}/comments`,{method:"POST",headers:{"Content-Type":"application/json",...t},credentials:"include",body:JSON.stringify({body:e})});if(!r.ok){I({type:"error",text:(await r.json().catch(()=>({}))).error??"Erreur."});return}let i=await r.json();Z(e=>[...e,i]),Q("")},children:"Commenter"})]})]})]}),(0,r.jsxs)("div",{className:"rounded-lg border border-webit-panel-border bg-slate-900/40 p-4",children:[r.jsx("p",{className:"mb-2 text-sm font-medium text-white",children:"Publication"}),r.jsx("div",{className:"mb-3 flex items-center gap-2",children:r.jsx("span",{className:`inline-flex rounded-full px-2.5 py-0.5 text-xs font-medium ${u[ex]}`,children:x[ex]})}),(0,r.jsxs)("div",{className:"mb-4 grid gap-2 text-sm",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"mb-0.5 block text-xs text-webit-fg-muted",children:"Publier \xe0 partir de"}),r.jsx("input",{type:"datetime-local",className:"w-full rounded border border-webit-panel-border bg-slate-900 px-2 py-1.5 text-white",value:X?X.slice(0,16):"",onChange:e=>G(e.target.value?new Date(e.target.value).toISOString():null)})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"mb-0.5 block text-xs text-webit-fg-muted",children:"D\xe9publier \xe0"}),r.jsx("input",{type:"datetime-local",className:"w-full rounded border border-webit-panel-border bg-slate-900 px-2 py-1.5 text-white",value:z?z.slice(0,16):"",onChange:e=>V(e.target.value?new Date(e.target.value).toISOString():null)})]}),X&&new Date(X)>new Date&&(0,r.jsxs)("p",{className:"text-xs text-amber-400",children:["Publication planifi\xe9e le ",new Date(X).toLocaleString("fr-FR")]}),z&&(0,r.jsxs)("p",{className:"text-xs text-webit-fg-muted",children:["Sera d\xe9publi\xe9 le ",new Date(z).toLocaleString("fr-FR")]})]}),(0,r.jsxs)("div",{className:"mb-4 space-y-1 text-xs text-webit-fg-muted",children:[s.current.publishedAt&&(0,r.jsxs)("p",{children:["Publi\xe9 le : ",o(s.current.publishedAt)]}),(0,r.jsxs)("p",{children:["Derni\xe8re mise \xe0 jour : ",o(s.updatedAt)]})]}),_.length>0&&(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("p",{className:"mb-2 text-xs font-medium text-webit-fg-muted",children:"Historique des statuts"}),r.jsx("ul",{className:"space-y-1 text-xs text-webit-fg-muted",children:_.map(e=>(0,r.jsxs)("li",{children:[o(e.changedAt)," –"," ",e.fromStatus&&x[e.fromStatus]||"—"," →"," ",x[e.toStatus],e.changedByUserName&&` par ${e.changedByUserName}`]},e.id))})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:["draft"===ex&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("button",{type:"button",className:"btn-secondary text-sm",onClick:()=>ed("preview"),disabled:el,children:"Passer en preview"}),r.jsx("button",{type:"button",className:"btn-primary text-sm",onClick:()=>ed("published"),disabled:el,children:"Publier"})]}),"preview"===ex&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("button",{type:"button",className:"btn-secondary text-sm",onClick:()=>ed("draft"),disabled:el,children:"Repasser en brouillon"}),r.jsx("button",{type:"button",className:"btn-primary text-sm",onClick:()=>ed("published"),disabled:el,children:"Publier"})]}),"published"===ex&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("button",{type:"button",className:"btn-secondary text-sm",onClick:()=>ed("draft"),disabled:el,children:"Repasser en brouillon"}),r.jsx("button",{type:"button",className:"btn-secondary text-sm",onClick:()=>ed("archived"),disabled:el,children:"Archiver"})]}),"archived"===ex&&r.jsx("button",{type:"button",className:"btn-secondary text-sm",onClick:()=>ed("draft"),disabled:el,children:"Repasser en brouillon"})]})]}),(0,r.jsxs)("div",{className:"rounded-lg border border-webit-panel-border bg-slate-900/40 p-4",children:[r.jsx("p",{className:"mb-3 text-sm font-medium text-white",children:"Historique des versions"}),R?r.jsx("p",{className:"text-xs text-webit-fg-muted",children:"Chargement…"}):0===q.length?r.jsx("p",{className:"text-xs text-webit-fg-muted",children:"Aucune version enregistr\xe9e."}):r.jsx("ul",{className:"mb-4 space-y-2",children:q.map(e=>(0,r.jsxs)("li",{className:"flex flex-wrap items-center justify-between gap-2 rounded border border-webit-panel-border/60 bg-slate-800/40 px-3 py-2 text-sm",children:[(0,r.jsxs)("span",{className:"text-white",children:["Version ",e.versionNumber," \xb7 ",o(e.createdAt),e.createdByUserName&&` \xb7 ${e.createdByUserName}`]}),(0,r.jsxs)("span",{className:"flex gap-2",children:[r.jsx("button",{type:"button",className:"text-webit-accent hover:underline",onClick:()=>B(O?.id===e.id?null:e),children:O?.id===e.id?"Masquer la comparaison":"Comparer \xe0 actuel"}),r.jsx("button",{type:"button",className:"text-webit-accent-rose hover:underline disabled:opacity-50",onClick:()=>ec(e.versionNumber),disabled:null!==F,children:F===e.versionNumber?"Restauration…":"Restaurer cette version"})]})]},e.id))}),O&&s&&(0,r.jsxs)("div",{className:"rounded border border-webit-panel-border bg-slate-950/60 p-3 text-xs",children:[(0,r.jsxs)("p",{className:"mb-2 font-medium text-webit-fg-muted",children:["Diff (version ",O.versionNumber," vs actuel)"]}),(0,r.jsxs)("dl",{className:"space-y-1",children:[O.payload.title!==s.current.title&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("dt",{className:"text-webit-fg-muted",children:"Titre"}),(0,r.jsxs)("dd",{className:"ml-4",children:[r.jsx("span",{className:"line-through text-red-300",children:O.payload.title||"—"})," → ",r.jsx("span",{className:"text-emerald-300",children:s.current.title||"—"})]})]}),O.payload.slug!==s.current.slug&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("dt",{className:"text-webit-fg-muted",children:"Slug"}),(0,r.jsxs)("dd",{className:"ml-4",children:[r.jsx("span",{className:"line-through text-red-300",children:O.payload.slug||"—"})," → ",r.jsx("span",{className:"text-emerald-300",children:s.current.slug||"—"})]})]}),(O.payload.seoTitle??"")!==(s.current.seoTitle??"")&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("dt",{className:"text-webit-fg-muted",children:"SEO Title"}),(0,r.jsxs)("dd",{className:"ml-4",children:[r.jsx("span",{className:"line-through text-red-300",children:O.payload.seoTitle||"—"})," → ",r.jsx("span",{className:"text-emerald-300",children:s.current.seoTitle||"—"})]})]}),(O.payload.seoDescription??"")!==(s.current.seoDescription??"")&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("dt",{className:"text-webit-fg-muted",children:"SEO Description"}),(0,r.jsxs)("dd",{className:"ml-4 truncate",children:[r.jsx("span",{className:"line-through text-red-300",children:O.payload.seoDescription||"—"})," → ",r.jsx("span",{className:"text-emerald-300",children:s.current.seoDescription||"—"})]})]}),JSON.stringify(O.payload.blocks??[])!==JSON.stringify(s.current.blocks??[])&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("dt",{className:"text-webit-fg-muted",children:"Blocs"}),r.jsx("dd",{className:"ml-4 text-webit-fg-muted",children:"Contenu modifi\xe9"})]})]})]})]}),(0,r.jsxs)("div",{className:"rounded-lg border border-webit-panel-border bg-slate-900/40 p-4",children:[r.jsx("p",{className:"mb-3 text-sm font-medium text-white",children:"M\xe9tadonn\xe9es"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"mb-1 block text-xs text-webit-fg-muted",children:"Cat\xe9gorie"}),(0,r.jsxs)("select",{className:"w-full rounded border border-webit-panel-border bg-slate-900 px-3 py-2 text-sm text-white",value:f??"",onChange:e=>j(e.target.value||null),children:[r.jsx("option",{value:"",children:"Aucune"}),p.map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"mb-2 block text-xs text-webit-fg-muted",children:"Tags"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[b.map(e=>(0,r.jsxs)("label",{className:"flex cursor-pointer items-center gap-1.5 text-sm text-white",children:[r.jsx("input",{type:"checkbox",checked:w.includes(e.id),onChange:t=>{t.target.checked?y(t=>[...t,e.id]):y(t=>t.filter(t=>t!==e.id))},className:"rounded border-webit-panel-border"}),e.name]},e.id)),0===b.length&&r.jsx("span",{className:"text-xs text-webit-fg-muted",children:"Aucun tag cr\xe9\xe9."})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"mb-1 block text-xs text-webit-fg-muted",children:"Auteur"}),r.jsx("p",{className:"text-sm text-white",children:s.authorName||s.authorId||"—"})]})]}),r.jsx("button",{type:"button",className:"btn-primary mt-3 text-sm",onClick:eo,disabled:P,children:P?"Enregistrement…":"Enregistrer les m\xe9tadonn\xe9es"})]})]})]})}},28702:(e,t,s)=>{"use strict";s.d(t,{v9:()=>l});var r=s(42585),a=s(46791);let i={apiKey:process.env.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:process.env.NEXT_PUBLIC_FIREBASE_APP_ID};function l(){return(0,a.v0)(0===(0,r.C6)().length?(0,r.ZF)(i):(0,r.Mq)())}},89660:(e,t,s)=>{"use strict";async function r(){return{}}s.d(t,{g:()=>r}),s(28702)},31591:(e,t,s)=>{"use strict";s.d(t,{z:()=>a});var r=s(17577);function a(){let[e,t]=(0,r.useState)(null),[s,a]=(0,r.useState)(!0),[i,l]=(0,r.useState)(null);return{user:e,loading:s,error:i}}s(28702)},24988:(e,t,s)=>{"use strict";s.d(t,{X:()=>i});var r=s(89660),a=s(17577);function i(){let[e,t]=(0,a.useState)(null),[s,i]=(0,a.useState)(!0),[l,n]=(0,a.useState)(null);return{org:e,loading:s,error:l,refetch:(0,a.useCallback)(async()=>{n(null),i(!0);try{let e=await (0,r.g)(),s=await fetch("/api/orgs/current",{headers:{...e},credentials:"include"});if(401===s.status||403===s.status){t(null),n("Non autoris\xe9");return}if(404===s.status){t(null),n("Organisation non trouv\xe9e");return}if(!s.ok){t(null),n("Erreur au chargement");return}let a=await s.json();t(a)}catch{t(null),n("Erreur r\xe9seau")}finally{i(!1)}},[])}}},47999:(e,t,s)=>{"use strict";s.d(t,{Zj:()=>l,gC:()=>i,wR:()=>r});let r={not_needed:"Aucune revue n\xe9cessaire",in_review:"En revue",changes_requested:"Modifications demand\xe9es",approved:"Approuv\xe9"},a={not_needed:"bg-slate-600/80 text-slate-200",in_review:"bg-amber-600/80 text-white",changes_requested:"bg-rose-600/80 text-white",approved:"bg-emerald-600/80 text-white"};function i(e){return null==e?"—":r[e]??e}function l(e){return null==e?"bg-slate-600/80 text-slate-400":a[e]??"bg-slate-600/80 text-slate-300"}},90434:(e,t,s)=>{"use strict";s.d(t,{default:()=>a.a});var r=s(79404),a=s.n(r)},39997:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(68570).createProxy)(String.raw`C:\Projets - Developpement\cursor-webit-cop\app\(dashboard)\articles\[articleId]\edit\page.tsx#default`)},64095:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var r=s(19510);let a=(0,s(68570).createProxy)(String.raw`C:\Projets - Developpement\cursor-webit-cop\app\(dashboard)\DashboardShell.tsx#default`);function i({children:e}){return r.jsx(a,{children:e})}},11506:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i,metadata:()=>a});var r=s(19510);s(67272);let a={title:"Webit COP",description:"SaaS COP multi-tenant pour Webit"};function i({children:e}){return r.jsx("html",{lang:"fr",children:r.jsx("body",{children:e})})}},67272:()=>{}};var t=require("../../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[9276,4471,6484,9404],()=>s(49599));module.exports=r})();