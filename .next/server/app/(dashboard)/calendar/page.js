(()=>{var e={};e.id=645,e.ids=[645],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},74026:e=>{"use strict";e.exports=require("string_decoder")},98061:e=>{"use strict";e.exports=require("node:assert")},92761:e=>{"use strict";e.exports=require("node:async_hooks")},72254:e=>{"use strict";e.exports=require("node:buffer")},40027:e=>{"use strict";e.exports=require("node:console")},6005:e=>{"use strict";e.exports=require("node:crypto")},65714:e=>{"use strict";e.exports=require("node:diagnostics_channel")},15673:e=>{"use strict";e.exports=require("node:events")},88849:e=>{"use strict";e.exports=require("node:http")},42725:e=>{"use strict";e.exports=require("node:http2")},87503:e=>{"use strict";e.exports=require("node:net")},38846:e=>{"use strict";e.exports=require("node:perf_hooks")},39630:e=>{"use strict";e.exports=require("node:querystring")},84492:e=>{"use strict";e.exports=require("node:stream")},31764:e=>{"use strict";e.exports=require("node:tls")},41041:e=>{"use strict";e.exports=require("node:url")},47261:e=>{"use strict";e.exports=require("node:util")},93746:e=>{"use strict";e.exports=require("node:util/types")},24086:e=>{"use strict";e.exports=require("node:worker_threads")},65628:e=>{"use strict";e.exports=require("node:zlib")},44224:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>d,pages:()=>c,routeModule:()=>x,tree:()=>u}),s(92968),s(64095),s(35866),s(11506);var r=s(23191),a=s(88716),n=s(37922),i=s.n(n),l=s(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let u=["",{children:["(dashboard)",{children:["calendar",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,92968)),"C:\\Projets - Developpement\\cursor-webit-cop\\app\\(dashboard)\\calendar\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,64095)),"C:\\Projets - Developpement\\cursor-webit-cop\\app\\(dashboard)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,11506)),"C:\\Projets - Developpement\\cursor-webit-cop\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Projets - Developpement\\cursor-webit-cop\\app\\(dashboard)\\calendar\\page.tsx"],d="/(dashboard)/calendar/page",p={require:s,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(dashboard)/calendar/page",pathname:"/calendar",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:u}})},90783:(e,t,s)=>{Promise.resolve().then(s.bind(s,46952))},47142:(e,t,s)=>{Promise.resolve().then(s.bind(s,28034))},26444:()=>{},93710:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,12994,23)),Promise.resolve().then(s.t.bind(s,96114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,79671,23)),Promise.resolve().then(s.t.bind(s,41868,23)),Promise.resolve().then(s.t.bind(s,84759,23))},46952:(e,t,s)=>{"use strict";s.d(t,{default:()=>c});var r=s(10326),a=s(31591),n=s(24988),i=s(89660),l=s(17577),o=s(90434),u=s(35047);function c({children:e}){let{user:t,loading:s}=(0,a.z)(),{org:c,loading:d}=(0,n.X)(),{me:p}=function(){let[e,t]=(0,l.useState)(null),[s,r]=(0,l.useState)(!0),[a,n]=(0,l.useState)(null);return{me:e,loading:s,error:a,refetch:(0,l.useCallback)(async()=>{n(null),r(!0);try{let e=await (0,i.g)(),s=await fetch("/api/orgs/current/me",{headers:{...e},credentials:"include"});if(401===s.status||403===s.status){t(null),n("Non autoris\xe9");return}if(!s.ok){t(null),n("Erreur au chargement");return}let r=await s.json();t(r)}catch{t(null),n("Erreur au chargement")}finally{r(!1)}},[])}}();return((0,u.useRouter)(),(0,u.usePathname)(),s)?r.jsx("div",{className:"flex min-h-screen items-center justify-center bg-[#050816]",children:r.jsx("p",{className:"text-webit-fg-muted",children:"Chargement…"})}):t?(0,r.jsxs)("div",{className:"min-h-screen bg-[#050816] text-webit-fg",children:[r.jsx("header",{className:"border-b border-webit-panel-border",children:(0,r.jsxs)("div",{className:"layout-container flex h-14 items-center justify-between gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-6",children:[r.jsx(o.default,{href:"/pages",className:"text-sm font-semibold text-white hover:text-webit-accent",children:"Webit COP"}),(0,r.jsxs)("nav",{className:"flex gap-4",children:[r.jsx(o.default,{href:"/pages",className:"text-sm text-webit-fg-muted hover:text-webit-accent",children:"Pages"}),r.jsx(o.default,{href:"/articles",className:"text-sm text-webit-fg-muted hover:text-webit-accent",children:"Articles"}),r.jsx(o.default,{href:"/calendar",className:"text-sm text-webit-fg-muted hover:text-webit-accent",children:"Calendrier"}),p?.canManageMembers&&r.jsx(o.default,{href:"/org/members",className:"text-sm text-webit-fg-muted hover:text-webit-accent",children:"Membres & r\xf4les"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[t&&!d&&(0,r.jsxs)("span",{className:"text-webit-fg-muted",children:["Organisation : ",c?.name??"Organisation inconnue"]}),p&&(0,r.jsxs)("span",{className:"text-webit-fg-muted",title:"R\xf4le dans cette organisation",children:["Vous : ",p.orgRole]}),r.jsx("span",{className:"text-webit-fg-muted",children:t.displayName||t.email||t.uid}),r.jsx(o.default,{href:"/logout",className:"text-webit-fg-muted hover:text-webit-accent-rose",children:"D\xe9connexion"})]})]})}),e]}):null}},28034:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var r=s(10326),a=s(89660),n=s(35047),i=s(17577),l=s(24988);function o(){let e=(0,n.useRouter)(),{org:t}=(0,l.X)(),[s,o]=(0,i.useState)([]),[u,c]=(0,i.useState)(!0),[d,p]=(0,i.useState)(null),[x,h]=(0,i.useState)("all"),[m,b]=(0,i.useState)(""),[g,f]=(0,i.useState)(()=>{let e=new Date;return e.setDate(1),e.setHours(0,0,0,0),e}),v=(0,i.useMemo)(()=>g.toISOString().slice(0,10),[g]),j=(0,i.useMemo)(()=>{let e=new Date(g);return e.setMonth(e.getMonth()+1),e.setDate(0),e.toISOString().slice(0,10)},[g]);(0,i.useCallback)(async()=>{p(null),c(!0);try{let e=await (0,a.g)(),t=new URLSearchParams;t.set("from",v),t.set("to",j),"all"!==x&&t.set("type",x),m&&t.set("locale",m);let s=await fetch(`/api/orgs/current/calendar?${t.toString()}`,{headers:{...e},credentials:"include"});if(401===s.status||403===s.status){p("Vous n’\xeates pas autoris\xe9."),o([]);return}if(!s.ok){let e=await s.json().catch(()=>({}));p(e.error??"Erreur au chargement.");return}let r=await s.json();o(r.items)}catch{p("Erreur r\xe9seau.")}finally{c(!1)}},[v,j,x,m]);let w=(0,i.useMemo)(()=>{let e=new Map;for(let t of s){if(t.publishAt){let s=t.publishAt.slice(0,10);e.has(s)||e.set(s,[]),e.get(s).push(t)}if(t.unpublishAt&&t.unpublishAt!==t.publishAt){let s=t.unpublishAt.slice(0,10);e.has(s)||e.set(s,[]),e.get(s).some(e=>e.id===t.id&&e.type===t.type)||e.get(s).push(t)}if(!t.publishAt&&!t.unpublishAt&&"published"===t.status){let s="live";e.has(s)||e.set(s,[]),e.get(s).push(t)}}return Array.from(e.entries()).sort(([e],[t])=>"live"===e?1:"live"===t?-1:e.localeCompare(t))},[s]),N=e=>"page"===e.type?`/pages/${e.id}/edit`:`/articles/${e.id}/edit`;return(0,r.jsxs)("div",{className:"layout-container py-8",children:[r.jsx("div",{className:"mb-6 flex flex-wrap items-center justify-between gap-4",children:r.jsx("h1",{className:"text-3xl font-semibold text-white",children:"Calendrier \xe9ditorial"})}),d&&r.jsx("p",{className:"mb-4 text-webit-accent-rose",children:d}),(0,r.jsxs)("div",{className:"mb-4 flex flex-wrap items-center gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("button",{type:"button",className:"btn-secondary text-sm",onClick:()=>{f(e=>{let t=new Date(e);return t.setMonth(t.getMonth()-1),t})},"aria-label":"Mois pr\xe9c\xe9dent",children:"←"}),r.jsx("span",{className:"min-w-[180px] text-center font-medium text-white",children:g.toLocaleDateString("fr-FR",{month:"long",year:"numeric"})}),r.jsx("button",{type:"button",className:"btn-secondary text-sm",onClick:()=>{f(e=>{let t=new Date(e);return t.setMonth(t.getMonth()+1),t})},"aria-label":"Mois suivant",children:"→"})]}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("label",{className:"text-sm text-webit-fg-muted",children:"Type :"}),(0,r.jsxs)("select",{className:"rounded border border-webit-panel-border bg-slate-900 px-2 py-1 text-sm text-white",value:x,onChange:e=>h(e.target.value),children:[r.jsx("option",{value:"all",children:"Tous"}),r.jsx("option",{value:"page",children:"Pages"}),r.jsx("option",{value:"article",children:"Articles"})]}),t?.supportedLocales&&t.supportedLocales.length>1&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("label",{className:"ml-2 text-sm text-webit-fg-muted",children:"Locale :"}),(0,r.jsxs)("select",{className:"rounded border border-webit-panel-border bg-slate-900 px-2 py-1 text-sm text-white",value:m,onChange:e=>b(e.target.value),children:[r.jsx("option",{value:"",children:"Toutes"}),t.supportedLocales.map(e=>r.jsx("option",{value:e,children:e},e))]})]})]})]}),u?r.jsx("p",{className:"text-webit-fg-muted",children:"Chargement…"}):0===w.length?r.jsx("p",{className:"text-webit-fg-muted",children:"Aucun contenu planifi\xe9 ou publi\xe9 sur cette p\xe9riode."}):r.jsx("div",{className:"space-y-6",children:w.map(([t,s])=>(0,r.jsxs)("div",{className:"rounded-lg border border-webit-panel-border bg-slate-900/40 p-4",children:[r.jsx("h2",{className:"mb-3 text-sm font-medium text-white",children:"live"===t?"Publi\xe9 (sans date de planification)":function(e){try{return new Date(e).toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"})}catch{return e}}(t+"T12:00:00.000Z")}),r.jsx("ul",{className:"space-y-2",children:s.map(s=>r.jsx("li",{children:(0,r.jsxs)("a",{href:N(s),onClick:t=>{t.preventDefault(),e.push(N(s))},className:"flex flex-wrap items-center gap-2 rounded border border-webit-panel-border/60 bg-slate-800/40 px-3 py-2 text-sm text-white transition hover:border-webit-accent/50 hover:bg-slate-800/80",children:[r.jsx("span",{className:"inline-flex rounded px-1.5 py-0.5 text-xs font-medium",title:"page"===s.type?"Page":"Article",children:"page"===s.type?"\uD83D\uDCC4":"\uD83D\uDCDD"}),r.jsx("span",{className:"font-mono text-webit-fg-muted",children:s.locale}),r.jsx("span",{className:"flex-1 truncate",children:s.title||s.slug||"Sans titre"}),s.publishAt&&t===s.publishAt.slice(0,10)&&r.jsx("span",{className:"text-xs text-emerald-400",children:"Publier"}),s.unpublishAt&&t===s.unpublishAt.slice(0,10)&&r.jsx("span",{className:"text-xs text-amber-400",children:"D\xe9publier"}),"published"===s.status&&r.jsx("span",{className:"rounded bg-emerald-600/80 px-1.5 py-0.5 text-xs text-white",children:"Publi\xe9"}),"in_review"===s.editorialStatus&&r.jsx("span",{className:"text-amber-400",title:"En revue",children:"⚠"}),"changes_requested"===s.editorialStatus&&r.jsx("span",{className:"text-rose-400",title:"Modifications demand\xe9es",children:"!"}),"approved"===s.editorialStatus&&r.jsx("span",{className:"text-emerald-400",title:"Approuv\xe9",children:"✓"})]})},`${s.type}-${s.id}`))})]},t))})]})}},28702:(e,t,s)=>{"use strict";s.d(t,{v9:()=>i});var r=s(42585),a=s(46791);let n={apiKey:process.env.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:process.env.NEXT_PUBLIC_FIREBASE_APP_ID};function i(){return(0,a.v0)(0===(0,r.C6)().length?(0,r.ZF)(n):(0,r.Mq)())}},89660:(e,t,s)=>{"use strict";async function r(){return{}}s.d(t,{g:()=>r}),s(28702)},31591:(e,t,s)=>{"use strict";s.d(t,{z:()=>a});var r=s(17577);function a(){let[e,t]=(0,r.useState)(null),[s,a]=(0,r.useState)(!0),[n,i]=(0,r.useState)(null);return{user:e,loading:s,error:n}}s(28702)},24988:(e,t,s)=>{"use strict";s.d(t,{X:()=>n});var r=s(89660),a=s(17577);function n(){let[e,t]=(0,a.useState)(null),[s,n]=(0,a.useState)(!0),[i,l]=(0,a.useState)(null);return{org:e,loading:s,error:i,refetch:(0,a.useCallback)(async()=>{l(null),n(!0);try{let e=await (0,r.g)(),s=await fetch("/api/orgs/current",{headers:{...e},credentials:"include"});if(401===s.status||403===s.status){t(null),l("Non autoris\xe9");return}if(404===s.status){t(null),l("Organisation non trouv\xe9e");return}if(!s.ok){t(null),l("Erreur au chargement");return}let a=await s.json();t(a)}catch{t(null),l("Erreur r\xe9seau")}finally{n(!1)}},[])}}},90434:(e,t,s)=>{"use strict";s.d(t,{default:()=>a.a});var r=s(79404),a=s.n(r)},92968:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(68570).createProxy)(String.raw`C:\Projets - Developpement\cursor-webit-cop\app\(dashboard)\calendar\page.tsx#default`)},64095:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var r=s(19510);let a=(0,s(68570).createProxy)(String.raw`C:\Projets - Developpement\cursor-webit-cop\app\(dashboard)\DashboardShell.tsx#default`);function n({children:e}){return r.jsx(a,{children:e})}},11506:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n,metadata:()=>a});var r=s(19510);s(67272);let a={title:"Webit COP",description:"SaaS COP multi-tenant pour Webit"};function n({children:e}){return r.jsx("html",{lang:"fr",children:r.jsx("body",{children:e})})}},67272:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[9276,4471,6484,9404],()=>s(44224));module.exports=r})();