"use strict";(()=>{var e={};e.id=5375,e.ids=[5375],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3263:e=>{e.exports=import("firebase-admin/app")},79637:e=>{e.exports=import("firebase-admin/auth")},72929:e=>{e.exports=import("firebase-admin/firestore")},80043:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{originalPathname:()=>g,patchFetch:()=>p,requestAsyncStorage:()=>c,routeModule:()=>d,serverHooks:()=>l,staticGenerationAsyncStorage:()=>m});var o=t(49303),n=t(88716),a=t(60670),i=t(63755),u=e([i]);i=(u.then?(await u)():u)[0];let d=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/orgs/current/members/[userId]/route",pathname:"/api/orgs/current/members/[userId]",filename:"route",bundlePath:"app/api/orgs/current/members/[userId]/route"},resolvedPagePath:"C:\\Projets - Developpement\\cursor-webit-cop\\app\\api\\orgs\\current\\members\\[userId]\\route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:c,staticGenerationAsyncStorage:m,serverHooks:l}=d,g="/api/orgs/current/members/[userId]/route";function p(){return(0,a.patchFetch)({serverHooks:l,staticGenerationAsyncStorage:m})}s()}catch(e){s(e)}})},63755:(e,r,t)=>{t.a(e,async(e,s)=>{try{t.r(r),t.d(r,{DELETE:()=>p});var o=t(87070),n=t(90455),a=t(76899),i=t(7331),u=e([n,i]);async function p(e,{params:r}){try{let e=await (0,n.$9)();(0,n.Ql)(e,"org.manage_members");let t=await (0,i.Xu)(e.orgId);if(!t)return o.NextResponse.json({error:"Organisation non trouv\xe9e"},{status:404});let s=[...t.members??[]],a=decodeURIComponent(r.userId||""),u=a.includes("@"),p=u?s.find(e=>e.userEmail.toLowerCase()===a.toLowerCase()):s.find(e=>e.userId===a),d=s.filter(e=>"owner"===e.role);if(p?.role==="owner"&&d.length<=1)return o.NextResponse.json({error:"Impossible de retirer le dernier owner de l'organisation."},{status:400});let c=u?s.filter(e=>e.userEmail.toLowerCase()!==a.toLowerCase()):s.filter(e=>e.userId!==a);if(c.length===s.length)return o.NextResponse.json({error:"Membre non trouv\xe9"},{status:404});return await (0,i.FV)(e.orgId,{members:c,updatedAt:new Date().toISOString(),updatedBy:e.userId}),o.NextResponse.json({ok:!0})}catch(r){let e=(0,a.s)(r);if(e)return e;throw r}}[n,i]=u.then?(await u)():u,s()}catch(e){s(e)}})}};var r=require("../../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[9276,5972,4035],()=>t(80043));module.exports=s})();