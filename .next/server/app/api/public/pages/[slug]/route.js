"use strict";(()=>{var t={};t.id=9413,t.ids=[9413],t.modules={20399:t=>{t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:t=>{t.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3263:t=>{t.exports=import("firebase-admin/app")},79637:t=>{t.exports=import("firebase-admin/auth")},72929:t=>{t.exports=import("firebase-admin/firestore")},72223:(t,e,n)=>{n.a(t,async(t,a)=>{try{n.r(e),n.d(e,{originalPathname:()=>g,patchFetch:()=>o,requestAsyncStorage:()=>c,routeModule:()=>p,serverHooks:()=>A,staticGenerationAsyncStorage:()=>d});var r=n(49303),i=n(88716),u=n(60670),s=n(73780),l=t([s]);s=(l.then?(await l)():l)[0];let p=new r.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/public/pages/[slug]/route",pathname:"/api/public/pages/[slug]",filename:"route",bundlePath:"app/api/public/pages/[slug]/route"},resolvedPagePath:"C:\\Projets - Developpement\\cursor-webit-cop\\app\\api\\public\\pages\\[slug]\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:c,staticGenerationAsyncStorage:d,serverHooks:A}=p,g="/api/public/pages/[slug]/route";function o(){return(0,u.patchFetch)({serverHooks:A,staticGenerationAsyncStorage:d})}a()}catch(t){a(t)}})},73780:(t,e,n)=>{n.a(t,async(t,a)=>{try{n.r(e),n.d(e,{GET:()=>s});var r=n(87070),i=n(45487),u=t([i]);i=(u.then?(await u)():u)[0];let l=process.env.PUBLIC_ORG_ID;async function s(t,{params:e}){if(!l)return r.NextResponse.json({error:"Site public non configur\xe9 (PUBLIC_ORG_ID)"},{status:503});let n=await (0,i.sb)(l,e.slug);return n?r.NextResponse.json(n):r.NextResponse.json({error:"Page non trouv\xe9e"},{status:404})}a()}catch(t){a(t)}})},52099:(t,e,n)=>{n.a(t,async(t,a)=>{try{n.d(e,{C:()=>c,i:()=>d});var r=n(3263),i=n(79637),u=n(72929),s=t([r,i,u]);[r,i,u]=s.then?(await s)():s;let l=(0,r.getApps)(),o=!!process.env.FIREBASE_PROJECT_ID&&!!process.env.FIREBASE_CLIENT_EMAIL&&!!process.env.FIREBASE_PRIVATE_KEY;o||console.warn("Firebase Admin initialis\xe9 en mode limit\xe9 : variables FIREBASE_* manquantes dans l'environnement.");let p=l[0]??(o?(0,r.initializeApp)({credential:(0,r.cert)({projectId:process.env.FIREBASE_PROJECT_ID,clientEmail:process.env.FIREBASE_CLIENT_EMAIL,privateKey:process.env.FIREBASE_PRIVATE_KEY.replace(/\\n/g,"\n")}),databaseURL:process.env.FIREBASE_DATABASE_URL}):(0,r.initializeApp)()),c=o?(0,i.getAuth)(p):null,d=o?(0,u.getFirestore)(p):null;a()}catch(t){a(t)}})},97681:(t,e,n)=>{n.a(t,async(t,a)=>{try{n.d(e,{db:()=>u});var r=n(52099),i=t([r]);let u=(r=(i.then?(await i)():i)[0]).i;a()}catch(t){a(t)}})},48680:(t,e,n)=>{n.a(t,async(t,a)=>{try{n.d(e,{B:()=>s,b:()=>u});var r=n(72929),i=t([r]);function u(t){return t?"string"==typeof t?t:t.toDate().toISOString():new Date(0).toISOString()}function s(t){return r.Timestamp.fromDate(new Date(t))}r=(i.then?(await i)():i)[0],a()}catch(t){a(t)}})},45487:(t,e,n)=>{n.a(t,async(t,a)=>{try{n.d(e,{D4:()=>g,Jq:()=>A,fx:()=>p,sb:()=>d,u5:()=>c});var r=n(97681),i=n(48680),u=n(32630),s=t([r,i]);function l(t){return r.db.collection("organizations").doc(t).collection("pages")}function o(t,e){let n={...e,id:t},a=n.locale??"fr-CA",r=n.translationGroupId??null,u=n.translations??[],s=n.publishAt??null,l=n.unpublishAt??null,o=n.editorialStatus??null,p=n.assignment??null;return{...n,locale:a,translationGroupId:r,translations:u,publishAt:s,unpublishAt:l,editorialStatus:o,assignment:p,createdAt:(0,i.b)(n.createdAt),updatedAt:(0,i.b)(n.updatedAt)}}async function p(t,e){let n=await l(t).doc(e).get();return n.exists?o(n.id,n.data()):null}async function c(t){return(await l(t).get()).docs.map(t=>o(t.id,t.data()))}async function d(t,e,n){let a=await c(t),r=n?.locale??n?.defaultLocale??"fr-CA";return a.find(t=>t.current.slug===e&&t.locale===r&&(0,u.C2)(t))||null}async function A(t){let e=l(t.orgId).doc(t.id),n={...t,createdAt:(0,i.B)(t.createdAt),updatedAt:(0,i.B)(t.updatedAt)};await e.set(n,{merge:!0})}async function g(t){let e=new Date().toISOString(),n={id:l(t.orgId).doc().id,orgId:t.orgId,type:"page",status:t.status,createdAt:e,updatedAt:e,createdBy:t.createdBy,updatedBy:t.createdBy,version:1,current:t.payload,history:t.history,locale:t.locale??"fr-CA",translationGroupId:t.translationGroupId??null,translations:t.translations??[],publishAt:null,unpublishAt:null,editorialStatus:null,assignment:null};return await A(n),n}[r,i]=s.then?(await s)():s,a()}catch(t){a(t)}})},32630:(t,e,n)=>{function a(t,e=new Date){if("published"!==t.status)return!1;let n=e.toISOString();return(null==t.publishAt||""===t.publishAt||!(t.publishAt>n))&&(null==t.unpublishAt||""===t.unpublishAt||!(t.unpublishAt<=n))}function r(t,e){let n=t=>{if(null==t||""===t)return null;let e=new Date(t);return Number.isNaN(e.getTime())?null:e},a=n(t),r=n(e);return null!=t&&""!==t&&null===a?{error:"Format de date invalide pour publishAt (attendu ISO date-time)"}:null!=e&&""!==e&&null===r?{error:"Format de date invalide pour unpublishAt (attendu ISO date-time)"}:null!=a&&null!=r&&a>r?{error:"publishAt ne peut pas \xeatre post\xe9rieur \xe0 unpublishAt"}:{}}function i(t,e){let n=t.supportedLocales??[],a=t.defaultLocale??"fr-CA";return e&&""!==e.trim()&&n.includes(e)?e:a}n.d(e,{C2:()=>a,RZ:()=>r,jR:()=>i})}};var e=require("../../../../../webpack-runtime.js");e.C(t);var n=t=>e(e.s=t),a=e.X(0,[9276,5972],()=>n(72223));module.exports=a})();