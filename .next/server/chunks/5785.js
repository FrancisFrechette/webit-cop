"use strict";exports.id=5785,exports.ids=[5785],exports.modules={92168:(t,e,r)=>{r.d(e,{DN:()=>s,u:()=>a});var l=r(3485);let i=new Set("le la les un une des du de ce cette ces mon ma mes ton ta tes son sa ses notre votre leur je tu il elle on nous vous ils elles et ou mais que qui dont o\xf9 avec sans sous sur pour dans par ici l\xe0 alors donc or ni".split(" "));function n(t){return(t??"").toLowerCase().trim().normalize("NFD").replace(/\p{Diacritic}/gu,"").replace(/\s+/g," ").split(" ").filter(t=>t.length>1&&!i.has(t)).join(" ")}function a(t){if(!t?.length)return"";let e=[];for(let r of t)switch(r.type){case"hero":e.push(r.title??""),e.push(r.subtitle??"");break;case"richText":e.push((r.html??"").replace(/<[^>]+>/g," ").replace(/\s+/g," ").trim());break;case"faq":for(let t of r.items??[])e.push(t.question??"",t.answer??"");break;case"cta":e.push(r.label??"")}return e.filter(Boolean).join(" ")}async function o(t,e){let r=await (0,l.G$)({orgId:t,status:"published",limit:500,orderBy:"publishedAt",direction:"desc"}),i=[];for(let t of r.items){let e=t.current?.title??"",r=t.current?.excerpt??"",l=a(t.current?.blocks),o=n([e,r,l].filter(Boolean).join(" "));i.push({id:t.id,slug:t.current?.slug??"",title:e,excerpt:r,contentText:l,searchText:o,publishedAt:t.current?.publishedAt??t.updatedAt??t.createdAt??"",categoryId:t.categoryId??null,tagIds:t.tagIds??[],authorId:t.authorId??null,article:t})}return i}async function s(t,e,r={}){let l=(e??"").trim();if(l.length<2)return{items:[],query:l,limit:r.limit??20};let i=n(l).split(" ").filter(Boolean);if(0===i.length)return{items:[],query:l,limit:r.limit??20};let a=await o(t,r.locale);null!=r.categoryId&&""!==r.categoryId&&(a=a.filter(t=>t.categoryId===r.categoryId)),null!=r.tagId&&""!==r.tagId&&(a=a.filter(t=>t.tagIds.includes(r.tagId))),null!=r.authorId&&""!==r.authorId&&(a=a.filter(t=>t.authorId===r.authorId));let s=Math.min(r.limit??20,50);return{items:a.map(t=>({article:t.article,score:function(t,e){let r=t.searchText,l=n(t.title),i=n(t.excerpt),a=0;for(let t of e){if(t&&!(t.length<2))a+=5*(l.includes(t)?1:0)+2*(i.includes(t)?1:0)+(r.includes(t)?1:0)}return a}(t,i)})).filter(t=>t.score>0).sort((t,e)=>e.score!==t.score?e.score-t.score:(e.article.current?.publishedAt??e.article.updatedAt??"").localeCompare(t.article.current?.publishedAt??t.article.updatedAt??"")).slice(0,s),query:l,limit:s}}},45785:(t,e,r)=>{r.d(e,{syncPageToSearchIndex:()=>h});var l=r(92168),i=r(32630),n=r(85650);function a(t){return(t??"").toLowerCase().trim().normalize("NFD").replace(/\p{Diacritic}/gu,"").replace(/\s+/g," ").trim()}function o(t){return`${t.orgId}:${t.id}`}let s=new Map,c={async indexDocuments(t){for(let e of t)s.set(o(e),{...e})},async deleteDocuments(t){for(let{id:e,orgId:r}of t)s.delete(o({id:e,orgId:r}))},async clearOrg(t){let e=`${t}:`;for(let t of Array.from(s.keys()))t.startsWith(e)&&s.delete(t)},async search(t){let e=(t.q??"").trim();if(e.length<2)return{items:[],total:0};let r=a(e).split(" ").filter(Boolean);if(0===r.length)return{items:[],total:0};let l=Array.from(s.values()).filter(e=>e.orgId===t.orgId);t.locale&&(l=l.filter(e=>e.locale===t.locale)),t.type&&(l=l.filter(e=>e.type===t.type)),null!=t.categoryId&&""!==t.categoryId&&(l=l.filter(e=>e.categoryId===t.categoryId)),null!=t.tagId&&""!==t.tagId&&(l=l.filter(e=>e.tagIds?.includes(t.tagId))),null!=t.authorId&&""!==t.authorId&&(l=l.filter(e=>e.authorId===t.authorId));let i=Math.min(t.limit??20,50),n=Math.max(0,t.offset??0),o=l.map(t=>({doc:t,score:function(t,e){let r=a(t.title),l=a(t.excerpt??""),i=a(t.contentText??""),n=0;for(let t of e){if(t&&!(t.length<2))n+=5*(r.includes(t)?1:0)+2*(l.includes(t)?1:0)+(i.includes(t)?1:0)}return n}(t,r),highlights:void 0})).filter(t=>t.score>0).sort((t,e)=>e.score!==t.score?e.score-t.score:(e.doc.publishedAt??"").localeCompare(t.doc.publishedAt??"")),c=o.length;return{items:o.slice(n,n+i),total:c}}};var u=r(19238);let d=null,g=null;async function h(t,e){let r=function(){let t=(0,n.R)();if(!t)return d=null,g=null,c;let e=`${t.host}:${t.indexPrefix}`;return d&&g===e||(d=new u.rm(t),g=e),d}();if((0,i.C2)(e)){let i=function(t,e,r){let i=function(){let t=process.env.NEXT_PUBLIC_APP_URL??process.env.VERCEL_URL;return t?(t.startsWith("http")?t:`https://${t}`).replace(/\/$/,""):"https://example.com"}(),n=e.current?.slug??e.id,a=e.current?.title??"",o=(0,l.u)(e.current?.blocks),s=function(t,e,r,l){let i=`/o/${e}/${r}`;return l?`${t}${i}?locale=${encodeURIComponent(l)}`:`${t}${i}`}(i,r,n,e.locale);return{id:e.id,orgId:t.id,type:"page",locale:e.locale??t.defaultLocale??"fr-CA",title:a,slug:n,excerpt:e.current?.seoDescription??void 0,contentText:o||void 0,publishedAt:null,url:s,categoryId:null,tagIds:[],authorId:null}}(t,e,t.slug);await r.indexDocuments([i])}else await r.deleteDocuments([{id:e.id,orgId:e.orgId}])}},85650:(t,e,r)=>{r.d(e,{R:()=>l});function l(){let t=process.env.MEILISEARCH_HOST?.trim(),e=process.env.MEILISEARCH_API_KEY?.trim();return t&&e?{host:t,apiKey:e,indexPrefix:process.env.MEILISEARCH_INDEX_PREFIX?.trim()??""}:null}},19238:(t,e,r)=>{r.d(e,{rm:()=>o});var l=r(95392);function i(t){return{id:`${t.orgId}:${t.id}`,orgId:t.orgId,type:t.type,locale:t.locale,title:t.title,slug:t.slug,excerpt:t.excerpt??"",contentText:t.contentText??"",publishedAt:t.publishedAt??null,url:t.url,categoryId:t.categoryId??null,tagIds:t.tagIds??[],authorId:t.authorId??null}}function n(t){let e=String(t.id??""),r={id:e.includes(":")?e.split(":").slice(1).join(":"):e,orgId:String(t.orgId??""),type:t.type??"article",locale:String(t.locale??""),title:String(t.title??""),slug:String(t.slug??""),excerpt:null!=t.excerpt?String(t.excerpt):void 0,contentText:null!=t.contentText?String(t.contentText):void 0,publishedAt:null!=t.publishedAt?String(t.publishedAt):null,url:String(t.url??""),categoryId:null!=t.categoryId?String(t.categoryId):null,tagIds:Array.isArray(t.tagIds)?t.tagIds:[],authorId:null!=t.authorId?String(t.authorId):null},l=t._formatted??{},i={title:null!=l.title?String(l.title):void 0,excerpt:null!=l.excerpt?String(l.excerpt):void 0,contentText:null!=l.contentText?String(l.contentText):void 0};return{doc:r,score:"number"==typeof t._rankingScore?t._rankingScore:0,highlights:Object.values(i).some(Boolean)?i:void 0}}r(85650);let a={searchableAttributes:["title","excerpt","contentText"],filterableAttributes:["orgId","type","locale","categoryId","tagIds","authorId"],sortableAttributes:["publishedAt"]};class o{constructor(t){this.client=new l.An({host:t.host,apiKey:t.apiKey}),this.indexPrefix=t.indexPrefix??""}getIndexNameForOrg(t){let e=t.replace(/[^a-zA-Z0-9_-]/g,"_");return`${this.indexPrefix}org_${e}_content`}async ensureIndexForOrg(t){let e=this.getIndexNameForOrg(t),r=this.client.index(e);try{"function"==typeof r.fetchIndexInfo?await r.fetchIndexInfo():"function"==typeof r.getStats&&await r.getStats()}catch{await this.client.createIndex(e,{primaryKey:"id"})}let l=this.client.index(e);await l.updateSettings(a)}async indexDocuments(t){if(0===t.length)return;let e=t[0].orgId;await this.ensureIndexForOrg(e);let r=this.getIndexNameForOrg(e),l=this.client.index(r),n=t.map(i);await l.addDocuments(n)}async deleteDocuments(t){if(0===t.length)return;let e=new Map;for(let{id:r,orgId:l}of t){let t=e.get(l)??[];t.push(`${l}:${r}`),e.set(l,t)}for(let[t,r]of e){let e=this.getIndexNameForOrg(t),l=this.client.index(e);await l.deleteDocuments(r)}}async clearOrg(t){try{let e=this.getIndexNameForOrg(t),r=this.client.index(e);await r.deleteAllDocuments()}catch{}}async search(t){let e=(t.q??"").trim();if(e.length<2)return{items:[],total:0};await this.ensureIndexForOrg(t.orgId);let r=this.getIndexNameForOrg(t.orgId),l=this.client.index(r),i=[`orgId = "${t.orgId}"`];t.locale&&i.push(`locale = "${t.locale}"`),t.type&&i.push(`type = "${t.type}"`),null!=t.categoryId&&""!==t.categoryId&&i.push(`categoryId = "${t.categoryId}"`),null!=t.tagId&&""!==t.tagId&&i.push(`tagIds = "${t.tagId}"`),null!=t.authorId&&""!==t.authorId&&i.push(`authorId = "${t.authorId}"`);let a={limit:Math.min(t.limit??20,50),offset:Math.max(0,t.offset??0),filter:i.length>0?i:void 0,attributesToHighlight:["title","excerpt","contentText"],highlightPreTag:"<mark>",highlightPostTag:"</mark>"};a.sort=["publishedAt:desc"];let o=await l.search(e,a),s=o.hits??[],c=o.estimatedTotalHits??s.length;return{items:s.map(n),total:c}}async health(){try{let t=await this.client.health();if("available"===t.status)return{status:"ok"};return{status:"degraded",message:String(t.status)}}catch(t){return{status:"error",message:t instanceof Error?t.message:String(t)}}}}}};