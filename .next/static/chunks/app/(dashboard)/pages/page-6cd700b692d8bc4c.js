(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[903],{7752:function(e,t,n){Promise.resolve().then(n.bind(n,3889))},5125:function(e,t,n){"use strict";n.d(t,{N:function(){return c}});var s=n(7437),r=n(8011);function a(e){var t;return{id:e.id,title:e.current.title,slug:e.current.slug,status:e.status,updatedAt:e.updatedAt,editorialStatus:null!==(t=e.editorialStatus)&&void 0!==t?t:null}}function i(e){var t;return{id:e.id,title:e.current.title,slug:e.current.slug,status:e.status,updatedAt:e.updatedAt,publishedAt:e.current.publishedAt,editorialStatus:null!==(t=e.editorialStatus)&&void 0!==t?t:null}}function u(e){try{return new Date(e).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"})}catch(t){return e}}function l(e){let{status:t}=e;return(0,s.jsx)("span",{className:"inline-flex rounded-full px-2.5 py-0.5 text-xs font-medium ".concat({draft:"bg-slate-600/80 text-slate-200",preview:"bg-amber-600/80 text-white",published:"bg-emerald-600/80 text-white",archived:"bg-slate-700/80 text-slate-400"}[t]),children:{draft:"Brouillon",preview:"Preview",published:"Publi\xe9",archived:"Archiv\xe9"}[t]})}function c(e){let{pages:t,articles:n,onRowClick:c,onDateSortClick:d,dateSortDirection:o="desc"}=e,p=void 0!==t?t.map(a):void 0!==n?n.map(i):[],h=void 0!==n;return(0,s.jsxs)("div",{className:"overflow-x-auto",children:[(0,s.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-webit-panel-border text-webit-fg-muted",children:[(0,s.jsx)("th",{className:"pb-3 pr-4 font-medium",children:"Titre"}),(0,s.jsx)("th",{className:"pb-3 pr-4 font-medium",children:"Slug"}),(0,s.jsx)("th",{className:"pb-3 pr-4 font-medium",children:"Statut"}),h&&(0,s.jsx)("th",{className:"pb-3 pr-4 font-medium",children:d?(0,s.jsxs)("button",{type:"button",onClick:e=>{e.stopPropagation(),d()},className:"flex items-center gap-1 hover:text-white focus:outline-none","aria-label":"Trier par date ".concat("desc"===o?"croissante":"d\xe9croissante"),children:["Publication",(0,s.jsx)("span",{"aria-hidden":!0,children:"desc"===o?"↓":"↑"})]}):"Publication"}),(0,s.jsx)("th",{className:"pb-3 font-medium",children:"Derni\xe8re maj"})]})}),(0,s.jsx)("tbody",{children:p.map(e=>(0,s.jsxs)("tr",{className:"cursor-pointer border-b border-webit-panel-border/60 transition hover:bg-slate-800/50",onClick:()=>c(e.id),children:[(0,s.jsx)("td",{className:"py-3 pr-4 font-medium text-white",children:e.title||"(Sans titre)"}),(0,s.jsx)("td",{className:"py-3 pr-4 text-webit-fg-muted",children:e.slug||"—"}),(0,s.jsx)("td",{className:"py-3 pr-4",children:(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-1.5",children:[(0,s.jsx)(l,{status:e.status}),"editorialStatus"in e&&e.editorialStatus&&(0,s.jsx)("span",{className:"inline-flex rounded-full px-2 py-0.5 text-xs ".concat((0,r.Zj)(e.editorialStatus)),title:(0,r.gC)(e.editorialStatus),children:(0,r.gC)(e.editorialStatus)})]})}),h&&(0,s.jsx)("td",{className:"py-3 pr-4 text-webit-fg-muted",children:"publishedAt"in e&&"string"==typeof e.publishedAt&&e.publishedAt?u(e.publishedAt):"—"}),(0,s.jsx)("td",{className:"py-3 text-webit-fg-muted",children:u(e.updatedAt)})]},e.id))})]}),0===p.length&&(0,s.jsx)("p",{className:"py-8 text-center text-webit-fg-muted",children:"Aucun contenu."})]})}},3889:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return l}});var s=n(7437),r=n(2954),a=n(9376),i=n(2265),u=n(5125);function l(){let e=(0,a.useRouter)(),[t,n]=(0,i.useState)([]),[l,c]=(0,i.useState)(!0),[d,o]=(0,i.useState)(null),p=(0,i.useCallback)(async()=>{o(null);try{let e=await (0,r.g)(),t=await fetch("/api/orgs/current/pages",{headers:{...e},credentials:"include"});if(401===t.status||403===t.status){o("Vous n’\xeates pas autoris\xe9 \xe0 voir cette liste."),n([]);return}if(!t.ok){o("Erreur au chargement des pages.");return}let s=await t.json();n(s)}catch(e){o("Erreur r\xe9seau.")}finally{c(!1)}},[]);(0,i.useEffect)(()=>{p()},[p]);let h=(0,i.useCallback)(t=>{e.push("/pages/".concat(t,"/edit"))},[e]);return l?(0,s.jsx)("div",{className:"layout-container py-12",children:(0,s.jsx)("p",{className:"text-webit-fg-muted",children:"Chargement…"})}):(0,s.jsxs)("div",{className:"layout-container py-8",children:[(0,s.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,s.jsx)("h1",{className:"text-3xl font-semibold text-white",children:"Pages"}),(0,s.jsx)("button",{type:"button",className:"btn-primary",onClick:()=>e.push("/pages/new/edit"),children:"Nouvelle page"})]}),d&&(0,s.jsx)("p",{className:"mb-4 text-webit-accent-rose",children:d}),(0,s.jsx)("div",{className:"panel",children:(0,s.jsx)(u.N,{pages:t,onRowClick:h})})]})}},469:function(e,t,n){"use strict";n.d(t,{v9:function(){return u}});var s=n(738),r=n(3301),a=n(257);let i={apiKey:a.env.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:a.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:a.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:a.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:a.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:a.env.NEXT_PUBLIC_FIREBASE_APP_ID};function u(){return(0,r.v0)(0===(0,s.C6)().length?(0,s.ZF)(i):(0,s.Mq)())}},2954:function(e,t,n){"use strict";n.d(t,{g:function(){return r}});var s=n(469);async function r(){try{let e=(0,s.v9)().currentUser;if(!e)return{};let t=await e.getIdToken();return{Authorization:"Bearer ".concat(t)}}catch(e){return{}}}},8011:function(e,t,n){"use strict";n.d(t,{Zj:function(){return i},gC:function(){return a},wR:function(){return s}});let s={not_needed:"Aucune revue n\xe9cessaire",in_review:"En revue",changes_requested:"Modifications demand\xe9es",approved:"Approuv\xe9"},r={not_needed:"bg-slate-600/80 text-slate-200",in_review:"bg-amber-600/80 text-white",changes_requested:"bg-rose-600/80 text-white",approved:"bg-emerald-600/80 text-white"};function a(e){var t;return null==e?"—":null!==(t=s[e])&&void 0!==t?t:e}function i(e){var t;return null==e?"bg-slate-600/80 text-slate-400":null!==(t=r[e])&&void 0!==t?t:"bg-slate-600/80 text-slate-300"}},9376:function(e,t,n){"use strict";var s=n(5475);n.o(s,"useParams")&&n.d(t,{useParams:function(){return s.useParams}}),n.o(s,"usePathname")&&n.d(t,{usePathname:function(){return s.usePathname}}),n.o(s,"useRouter")&&n.d(t,{useRouter:function(){return s.useRouter}})}},function(e){e.O(0,[139,685,971,117,744],function(){return e(e.s=7752)}),_N_E=e.O()}]);